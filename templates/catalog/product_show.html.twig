{% extends 'base.html.twig' %}

{% block title %}{{ product.name }} | TechNova{% endblock %}

{% block body %}
{# Bloc principal affichant la galerie et les infos produit #}
<section class="tn-product-layout">
    <div class="tn-product-gallery">
        {% set mainImage = product.images|first %}
        {% if mainImage %}
            <img src="{{ mainImage.url }}" alt="{{ mainImage.alt }}">
        {% else %}
            <img src="{{ asset('assets/images/product-placeholder.svg') }}" alt="Visuel par défaut">
        {% endif %}
        <div class="tn-product-gallery__thumbs">
            {% for image in product.images %}
                <img src="{{ image.url }}" alt="{{ image.alt }}">
            {% else %}
                <img src="{{ asset('assets/images/product-placeholder.svg') }}" alt="Visuel par défaut">
            {% endfor %}
        </div>
    </div>
    <div class="tn-product-info">
        <p class="tn-product-info__category">{{ product.category.name }}</p>
        <h1>{{ product.name }}</h1>
        <p class="tn-product-info__price">{{ product.price|number_format(2, ',', ' ') }} €</p>
        <p>{{ product.description }}</p>
        <a class="btn btn-primary" href="#">Ajouter au panier</a>
        <div class="tn-product-meta">
            <div>
                <strong>Marque</strong>
                <p>{{ product.brand ? product.brand.name : 'TechNova' }}</p>
            </div>
            <div>
                <strong>Stock</strong>
                <p>{{ product.stock > 0 ? product.stock ~ ' disponibles' : 'Rupture' }}</p>
            </div>
        </div>
    </div>
</section>

{# Caractéristiques synthétiques pour rappeler les points forts #}
<section class="tn-section">
    <div class="tn-section__header">
        <h2>Caractéristiques du produit</h2>
    </div>
    <div class="tn-product-specs">
        <ul>
            {% for label, value in specifications %}
                <li>
                    <strong>{{ label }}</strong><br>
                    {{ value }}
                </li>
            {% endfor %}
        </ul>
    </div>
</section>

{# Options (couleurs, variantes) #}
<section class="tn-section">
    <div class="tn-section__header">
        <h2>Options disponibles</h2>
    </div>
    <div class="tn-options">
        <div>
            <h3>Couleurs</h3>
            <div class="tn-chips">
                {% for color in options.colors %}
                    <span>{{ color }}</span>
                {% endfor %}
            </div>
        </div>
        <div>
            <h3>Variantes</h3>
            <div class="tn-chips">
                {% for variant in options.variants %}
                    <span>{{ variant }}</span>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

{# Avis clients fictifs issus des fixtures #}
<section class="tn-section">
    <div class="tn-section__header">
        <h2>Avis clients</h2>
    </div>
    <div class="tn-reviews">
        {% if product.reviews|length > 0 %}
            {% for review in product.reviews %}
                <article>
                    <strong>{{ review.rating }}/5</strong>
                    <p>{{ review.comment }}</p>
                </article>
            {% endfor %}
        {% else %}
            <p>Aucun avis pour le moment.</p>
        {% endif %}
    </div>
</section>
{% endblock %}
