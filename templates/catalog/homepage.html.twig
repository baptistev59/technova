{% extends 'base.html.twig' %}

{% block title %}Accueil | TechNova{% endblock %}

{% block body %}
{# Section hero : message marketing et call to action #}
<section class="tn-hero">
    <div class="tn-hero__text">
        <h1>Explorez le monde de l’innovation technologique</h1>
        <p>Trouvez les meilleurs produits tech, en quelques clics.</p>
        <div class="tn-hero__actions">
            <a href="{{ path('catalog_index') }}" class="btn btn-primary">Parcourir les produits</a>
            <a href="#" class="btn btn-outline">Découvrir les vendeurs</a>
        </div>
    </div>
    <div class="tn-hero__visual">
        <img src="{{ asset('images/hero/hero-immersive-lab.svg') }}" alt="Innovation TechNova">
    </div>
</section>

{# Mise en avant des catégories clés #}
<section class="tn-section">
    <div class="tn-section__header">
        <h2>Catégories populaires</h2>
    </div>
    <div class="tn-categories">
        {% for category in categories %}
            {% set iconPath = category.iconPath ?? 'images/categories/category-default.svg' %}
            <a class="tn-category-card" href="{{ path('catalog_index', { category: category.slug }) }}">
                <div class="tn-category-card__icon">
                    <img src="{{ asset(iconPath) }}" alt="Icône {{ category.name }}">
                </div>
                <p>{{ category.name }}</p>
            </a>
        {% else %}
            <p>Aucune catégorie disponible.</p>
        {% endfor %}
    </div>
</section>

{# Carrousel simplifié des derniers produits #}
<section class="tn-section">
    <div class="tn-section__header">
        <h2>Nouveautés</h2>
        <a href="{{ path('catalog_index') }}">Voir tout</a>
    </div>
    <div class="tn-products-grid">
        {% for product in latestProducts %}
            <article class="tn-product-card">
                {% set mainImage = product.images|first %}
                {% if mainImage %}
                    <img src="{{ mainImage.url }}" alt="{{ mainImage.alt }}">
                {% else %}
                    <img src="{{ asset('assets/images/product-placeholder.svg') }}" alt="Visuel par défaut">
                {% endif %}
                <h3>{{ product.name }}</h3>
                <div class="tn-product-card__meta">
                    <span>{{ product.brand ? product.brand.name : product.shop.name }}</span>
                    <strong>{{ product.price|number_format(2, ',', ' ') }} €</strong>
                </div>
                <div class="tn-product-card__cta">
                    <a class="btn btn-primary" href="{{ path('product_show', {slug: product.slug}) }}">Voir le produit</a>
                </div>
            </article>
        {% else %}
            <p>Aucun produit récent n'est disponible.</p>
        {% endfor %}
    </div>
</section>

{# Sélection "à la une" alimentée via isFeatured #}
<section class="tn-section">
    <div class="tn-section__header">
        <h2>Produits à la une</h2>
        <a href="{{ path('catalog_index', { sort: 'price_desc' }) }}">Découvrir la sélection</a>
    </div>
    <div class="tn-products-grid">
        {% for product in featuredProducts %}
            <article class="tn-product-card">
                {% set mainImage = product.images|first %}
                {% if mainImage %}
                    <img src="{{ mainImage.url }}" alt="{{ mainImage.alt }}">
                {% else %}
                    <img src="{{ asset('assets/images/product-placeholder.svg') }}" alt="Visuel par défaut">
                {% endif %}
                <h3>{{ product.name }}</h3>
                <div class="tn-product-card__meta">
                    <span>{{ product.brand ? product.brand.name : product.shop.name }}</span>
                    <strong>{{ product.price|number_format(2, ',', ' ') }} €</strong>
                </div>
                <div class="tn-product-card__cta">
                    <a class="btn btn-primary" href="{{ path('product_show', {slug: product.slug}) }}">Voir le produit</a>
                </div>
            </article>
        {% else %}
            <p>Aucun produit à la une pour le moment.</p>
        {% endfor %}
    </div>
</section>

{# Bandeau promotionnel inspiré de la maquette #}
<section class="tn-banner">
    <div>
        <p>Jusqu'à -30% sur les nouveautés tech</p>
        <a class="btn btn-outline" href="{{ path('catalog_index') }}">Voir les offres</a>
    </div>
</section>
{% endblock %}
